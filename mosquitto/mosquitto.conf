# Mosquitto Configuration for EVSE System
# Version: 2.0

# ========================================
# Network Listeners
# ========================================

# Standard MQTT listener
listener 1883
protocol mqtt

# WebSocket listener
listener 9001
protocol websockets

# ========================================
# Security
# ========================================

# Allow anonymous connections
# TODO: Enable authentication in production!
allow_anonymous true

# Uncomment and configure for authentication:
# password_file /mosquitto/config/passwd
# acl_file /mosquitto/config/acl

# ========================================
# Logging
# ========================================

log_dest stdout
log_dest file /mosquitto/log/mosquitto.log

log_type error
log_type warning
log_type notice
log_type information

# Disable debug and subscribe logs (too verbose)
# log_type debug
# log_type subscribe
# log_type unsubscribe

log_timestamp true
log_timestamp_format %Y-%m-%dT%H:%M:%S

# ========================================
# Connection Settings
# ========================================

max_keepalive 60
max_connections -1
max_inflight_messages 20
max_queued_messages 1000

# Message size limit (0 = unlimited)
message_size_limit 0

# ========================================
# Persistence
# ========================================

persistence true
persistence_location /mosquitto/data/
autosave_interval 1800
autosave_on_changes false

# ========================================
# Performance
# ========================================

# Memory limits
# max_inflight_bytes 0
# max_queued_bytes 0

# Connection timeouts
persistent_client_expiration 1h